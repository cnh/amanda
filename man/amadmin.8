.\"
.TH AMADMIN 8
.SH NAME
amadmin \- administrative interface to control Amanda backups
.SH SYNOPSIS
.B amadmin
.I config 
.I command
[ command options ] 

.SH DESCRIPTION

.B Amadmin
performs various administrative tasks on the Amanda configuration
specified by the \fIconfig\fR argument.  The 
.B amadmin
commands and their options are as follows.  All commands that take 
.I hostname [
.I disks ... ]
parameters operate on all the disks in the 
.I disklist
for that
.I hostname,
if no disks are specified.  The
.I disks
parameters are regular expressions,
for example "sd0" will match disks "sd0a" and "sd0g"
and "/mnt" will match "/mnt", "/mnt/a", and "/mnt/b",
while "^/mnt$" will match only "/mnt".
This is the same mechanism used by
.B amrestore.

.HP 5
.B version
.br
Shows the current version and some compile time and runtime parameters.

.HP 5
.B force
.I hostname [
.I disks ... ]
.br
Forces the 
.I disks
on the computer named by
.I hostname
to run a full level 0 backup on the next Amanda run.  

.HP 5
.B unforce
.I hostname [
.I disks ... ]
.br
Undoes a previous 
.B force
command.

.HP 5
.B find
.I hostname [
.I disks ... ]
.br
Displays, for each
.I disk,
all the dumps that are currently on tape for that disk.  The tape
label, file number, and status are displayed.

.HP 5
.B delete
.I hostname
.I disks ...
.br
Deletes all the specified 
.I disks
from the Amanda
.I curinfo
database.

.HP 5
.B info
.I hostname
.I disks ...
.br
Displays the 
.I curinfo
database record for each of the
.I disks.
Mostly used just for debugging.

.HP 5
.B tape
.br
Displays the label name of the tape Amanda is expecting to write to on
the next Amdump run. See also
.I amcheck(8).

.HP 5
.B bumpsize
.br
Displays the current bump threshold parameters, calculated for all backup
levels.

.HP 5
.B balance
.br
displays the distribution of full backups throughout the dump
schedule.  For example:
.EX
          $ amadmin csd balance
          due  #fs   orig KB    out KB  balance
          -------------------------------------
            0   21    930389    768753    +5.1%
            1   29   1236272    733211    +0.2%
            2   31   1552381    735796    +0.6%
            3   23   1368447    684552    -6.4%
            4   32   1065603    758155    +3.6%
            5   14   1300535    738430    +0.9%
            6   31   1362696    740365    +1.2%
            7   30   1427936    773397    +5.7%
            8   11   1059191    721786    -1.3%
            9   19   1108737    661867    -9.5%
          -------------------------------------
          TOT  241  12412187   7316312   731631
.EE
.PP
The 
.I due 
column is the number of days until the dumps are due for a full
backup.  Thus those dumps in row 0 are due for a full dump tonight.
.I #fs
shows the number of filesystems doing full dumps that night, and 
.I orig KB
and
.I out KB
show the total size of the dumps before and after any compression,
respectively.  The 
.I balance 
column shows how far off that night's dumps are from the average size
(shown at the bottom of the balance column).  Amanda tries to keep the
dumps balanced to with +/- 5%, but since the amount of data on each
filesystem is always changing, and Amanda will never delay dumps just
to rebalance the schedule, it is common for the schedule to fluctuate
by larger percentages.  In particular, in the case of a tape or dump
failure, a bump will occur the following night, which will not be
smoothed out until the next pass through the schedule.
.SH FILES
${exec_prefix}/bin/amadmin, /opt/amanda/config/<config>/amanda.conf

.SH AUTHOR
James da Silva <jds@cs.umd.edu>
.br
University of Maryland, College Park

.SH "SEE ALSO"
amanda(8), amcheck(8)
